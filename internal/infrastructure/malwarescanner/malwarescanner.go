package malwarescanner

import (
	"context"
	"errors"
)

// MalwareScanResult is the type of the malware scan result
type MalwareScanResult string

var (
	// MalwareScanResultDetected is the channel response when a malware has been detected
	MalwareScanResultDetected MalwareScanResult = "malware detected"
	// MalwareScanUnknownError is the channel response when an unknow error was responded by the malware scanner
	MalwareScanUnknownError MalwareScanResult = "unknown error"
	// MalwareScanResultClear is the channel response when a malware has not been detected
	MalwareScanResultClear MalwareScanResult = "clear"
)

var (
	// ErrMalswareURL is the error when a malware has been detected
	ErrMalswareURL error = errors.New("malware detected while scanning the URL")
)

// Scanner represents operations on malware scanner
type Scanner interface {
	Scan(ctx context.Context, url string, result chan<- MalwareScanResult)
}
