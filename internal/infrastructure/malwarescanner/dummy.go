package malwarescanner

import (
	"context"
	"strings"

	"github.com/golang/glog"
)

// DummyScanner represents a dummy scanner
type DummyScanner struct {
	MalwareKeyWords []string
}

// NewDummyScanner creates a dummy scanner
func NewDummyScanner() *DummyScanner {
	return &DummyScanner{
		MalwareKeyWords: []string{"malware", "virus"},
	}
}

// Scan implements Scanner interface
func (s *DummyScanner) Scan(ctx context.Context, url string, result chan<- MalwareScanResult) {
	glog.Infof("MALWARE ANALYSIS STARTED: %s", url)
	for _, keyword := range s.MalwareKeyWords {
		if strings.Contains(strings.ToLower(url), keyword) {
			glog.Info("MALWARE DETECTED")
			result <- MalwareScanResultDetected
			return
		}
	}
	result <- MalwareScanResultClear
}
